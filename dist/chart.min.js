function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)}var _createClass=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}(),_get=function(t,e,o){for(var i=!0;i;){var n=t,a=e,r=o;h=s=c=void 0,i=!1;var h=Object.getOwnPropertyDescriptor(n,a);if(void 0!==h){if("value"in h)return h.value;var c=h.get;return void 0===c?void 0:c.call(r)}var s=Object.getPrototypeOf(n);if(null===s)return void 0;t=s,e=a,o=r,i=!0}};!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("d3"),require("koto")):"function"==typeof define&&define.amd?define(["d3","koto"],e):t.KotoTooltip=e(t.d3,t.koto)}(this,function(t,e){"use strict";var o=[{name:"chartName",description:"Name of chart for Reporting.",type:"string",value:"Dropdown"},{name:"opacity",description:"Opacity of the tooltip. Useful for testing",type:"number",value:0},{name:"padding",description:"Padding for the group that goes into the tooltip",type:"number",value:7},{name:"caretSize",description:"Size of the caret on the tooltip",type:"number",value:5},{name:"stationary",description:"True if you want the tooltip stationary",type:"boolean",value:!1},{name:"maxWidth",description:"Max width for the tooltip",type:"number",value:200},{name:"format",description:"Format for the group in the tooltip",type:"string",value:"default"},{name:"tooltipBackgroundColor",description:"The background color for the tooltip",type:"color",value:"#fff"}],i=function(e){function i(e){function n(t,e){var o,i,n,a;return n=m(t.hittingRight,t.hittingLeft,t.offsetX+y.config("caretSize"),"width",e),a=t.topY,i=y._topPath.translate,o=0!==y._moveX?B("_topPath","x"):y._topPath.path,{translateX:n,translateY:a,translate:i,path:o}}function a(t,e){var o,i,n,a;return a=m(t.hittingBottom,t.hittingTop,t.centerY-y.config("padding"),"height",e),n=t.rightX,i=y._rightPath.translate,o=0!==y._moveY?B("_rightPath","y"):y._rightPath.path,{translateX:n,translateY:a,translate:i,path:o}}function r(t,e){var o,i,n,a;return n=m(t.hittingRight,t.hittingLeft,t.offsetX+y.config("caretSize")/2,"width",e),a=t.bottomY+y.config("padding")+5,i=y._bottomPath.translate,o=0!==y._moveX?B("_bottomPath","x"):y._bottomPath.path,{translateX:n,translateY:a,translate:i,path:o}}function h(t,e){var o,i,n,a;return a=m(t.hittingBottom,t.hittingTop,t.centerY-y.config("padding"),"height",e),n=t.leftX,i=y._leftPath.translate,o=0!==y._moveY?B("_leftPath","y"):y._leftPath.path,{translateX:n,translateY:a,translate:i,path:o}}function c(t,e,o,i){var c;switch(t){case"top":c=n(e,i);break;case"right":c=a(e,o);break;case"bottom":c=r(e,i);break;case"left":c=h(e,o)}return c}function s(t){var e="top";return!t.hittingRight&&!t.hittingLeft||t.closeToTop?(t.hittingRight||t.hittingLeft)&&t.closeToTop?e="bottom":t.hittingTop&&t.closeToRight?e="left":t.hittingTop&&t.closeToLeft?e="right":!t.hittingRight&&t.closeToRight?e="left":!t.hittingLeft&&t.closeToLeft?e="right":t.closeToBottom&&t.closeToTop?e="top":t.closeToTop&&(e="bottom"):e="top",e}function p(t,e,o){var i=y._gBBox,n=o.y-y._baseGroupBBox.height,a=o.x-y._baseGroupBBox.width/2,r=y._caretWidth,h=n-r,c=o.y+r,s=o.y-i.height/2,p=o.x-y._baseGroupBBox.width-y.config("caretSize"),l=o.x+r+5,g=o.x+y._baseGroupBBox.width/2>=t,f=o.x-y._baseGroupBBox.width/2<=0,d=o.y-y._baseGroupBBox.height-r-3<=0,u=o.y+y._baseGroupBBox.height>e,_=g&&o.x-y._baseGroupBBox.width-r<=0,m=f&&o.x+y._baseGroupBBox.width+r>=t,B=(g||f)&&o.y-y._baseGroupBBox.height/2<=0,v=(g||f)&&o.y+y._baseGroupBBox.height/2>=e;return{offsetX:a,topY:h,bottomY:c,centerY:s,leftX:p,rightX:l,closeToRight:g,closeToLeft:f,closeToTop:d,closeToBottom:u,hittingRight:_,hittingLeft:m,hittingTop:B,hittingBottom:v}}function l(t){y._baseGroupBBox.height="top"===t||"bottom"===t?y._gBBox.height+2*y.config("padding")+y.config("caretSize")+6:y._gBBox.height+2*y.config("padding")+6,y._baseGroupBBox.width="top"===t||"bottom"===t?y._gBBox.width+2*y.config("padding")+6:y._gBBox.width+2*y.config("padding")+y.config("caretSize")+6}function g(t){for(var e=!0,o=0;o<t.node().childNodes.length;o++){var i=t.node().childNodes[o].nodeName;if(e=o%2===0&&"text"===i?!0:"rect"===i,!e)break}return e}function f(t){var e=5,o=0,i={x:0,y:0,height:0,width:0};t.select("rect").attr("height",0),i=t.node().getBBox();for(var n=0;n<t.node().childNodes.length;n++){var a=t.node().childNodes[n];n%2===0?(t.select("text:nth-child("+(n+1)+")").attr({dy:function(){return _(this)},x:o+e*n+1,y:i.height/2}),o+=a.getBBox().width):t.select("rect:nth-child("+(n+1)+")").attr({x:o+e*n,y:0,width:1,height:i.height})}t.selectAll("tspan").attr({transform:function(){return"translate(0, "+_(this)+")"},y:i.height/2})}function d(){y._baseGroupBBox=x(y._baseGroup.node().getBBox()),y._baseGroupBBox.height=y._baseGroupBBox.height-y._caretWidth+3}function u(t,e){void 0!==t&&void 0!==e?y._gBBox={height:t,width:e}:y._gBBox=y._appends.node().getBBox()}function _(e){return.35*parseInt(t.select(e).style("font-size"),10)}function m(t,e,o,i,n){var a;return a=t?n-y._baseGroupBBox[i]+P:e?P:o}function B(t,e){var o,i;return i="y"===e?y[t].caretX+" "+(y[t].caretY-y._moveY):y[t].caretX+y._moveX+" "+y[t].caretY,o=y[t].path.match(/Z m (.*?) l/),y[t].path=y[t].path.replace(o[1],i),y[t].path}function v(t){var e,o,i,n,a=t.container,r=t.point,h=a.width-r.x,c=r.y,s=2*P;n=y._gBBox.height,i=y._gBBox.width;var p;t.left||t.right?(t.left&&(e=a.width-y._baseGroupBBox.width/2,y._moveX=e-h,i/2+y.config("caretSize")<=y._moveX&&(y._moveX=-(i/2+y.config("caretSize")))),t.right&&(e=y._baseGroupBBox.width/2,y._moveX=e-h,-(i/2+y.config("caretSize"))>=y._moveX&&(y._moveX=-(i/2+y.config("caretSize"))))):t.top||t.bottom?(t.top&&(o=y._baseGroupBBox.height/2,y._moveY=o-c,p=n/2+y.config("caretSize")-s,p<=y._moveY&&(y._moveY=p)),t.bottom&&(o=a.height-y._baseGroupBBox.height/2,y._moveY=o-c,p=-(n/2-y.config("caretSize"))-s,p>=y._moveY&&(y._moveY=p))):(y._moveX=0,y._moveY=0)}function b(){var t=y._gBBox.width+2*y.config("padding"),e=y._gBBox.height+2*y.config("padding"),o=y.config("caretSize"),i=e/2+y.config("caretSize")+P;y._topPath={translate:"translate("+t/2+","+(e+o+P)+")",caretX:t/2-o,caretY:e+2*P},y._topPath.path="m -"+t/2+" -"+(e+o+2*P)+" h "+t+" c 1.7 0 "+P+" 1.3 "+P+" "+P+" v "+e+" c 0 1.7 -1.3 "+P+" -"+P+" "+P+" h -"+t+" c -1.7 0 -"+P+" -1.3 -"+P+" -"+P+" v -"+e+" c 0 -1.7 1.3 -"+P+" "+P+" -"+P+" Z m "+y._topPath.caretX+" "+y._topPath.caretY+" l "+o+" "+o+" l "+o+" -"+o,y._bottomPath={translate:"translate("+t/2+","+(-o+P/2)+")",caretX:t/2-o,caretY:0},y._bottomPath.path="m -"+t/2+" 0 h "+t+" c 1.7 0 "+P+" 1.3 "+P+" "+P+" v "+e+" c 0 1.7 -1.3 "+P+" -"+P+" "+P+" h -"+t+" c -1.7 0 -"+P+" -1.3 -"+P+" -"+P+" v -"+e+" c 0 -1.7 1.3 -"+P+" "+P+" -"+P+" Z m "+y._bottomPath.caretX+" "+y._bottomPath.caretY+" l "+o+" -"+o+" l "+o+" "+o,y._leftPath={translate:"translate("+(t+o+P)+","+e/2+")",caretX:t+P,caretY:i},y._leftPath.path="m -"+(t+o+P)+" "+-(e/2+P)+" h "+t+" c 1.7 0 "+P+" 1.3 "+P+" "+P+" v "+e+" c 0 1.7 -1.3 "+P+" -"+P+" "+P+" h -"+t+" c -1.7 0 -"+P+" -1.3 -"+P+" -"+P+" v -"+e+" c 0 -1.7 1.3 -"+P+" "+P+" -"+P+" Z m "+y._leftPath.caretX+" "+y._leftPath.caretY+" l "+o+" -"+o+" l -"+o+" -"+o,y._rightPath={translate:"translate("+-(o+P)+","+e/2+")",caretX:-P,caretY:i},y._rightPath.path="m "+(o+P)+" "+-(e/2+P)+" h "+t+" c 1.7 0 "+P+" 1.3 "+P+" "+P+" v "+e+" c 0 1.7 -1.3 "+P+" -"+P+" "+P+" h -"+t+" c -1.7 0 -"+P+" -1.3 -"+P+" -"+P+" v -"+e+" c 0 -1.7 1.3 -"+P+" "+P+" -"+P+" Z m "+y._rightPath.caretX+" "+y._rightPath.caretY+" l -"+o+" -"+o+" l "+o+" -"+o+" Z"}function x(t){return{x:t.x,y:t.y,width:t.width,height:t.height}}_classCallCheck(this,i),_get(Object.getPrototypeOf(i.prototype),"constructor",this).call(this,e);var y=this;o.forEach(function(t){y.configs.set(t.name,t)}),y.configs.set("container",{description:"Container for the tooltip to get its bounds from",type:"d3 selected element",value:this.base});var w={"default":function(){},text:function(t){if(1===t[0].length&&"text"===t.node().childNodes[0].nodeName){var e=t.node().childNodes[0].getBBox();t.select("text").attr({dy:function(){return _(this)},y:e.height/2}),t.selectAll("tspan").attr({dy:function(){return _(this)},y:e.height/2})}},textBlock:function(e){var o=e.select("text"),i=o.node().getBoundingClientRect().height;t.domoStrings.wrapText(o,y.config("maxWidth")),e.select("text").attr({y:i-i/4})},textRectText:function(t){t.node().childNodes.length%2!==0&&g(t)&&f(t)}},P=3;this._baseGroup=this.base.append("g").attr("transform","translate(0, 0)").style("pointer-events","none"),y._parent=y._baseGroup.node().parentNode,this._baseGroup.append("path").attr("class","toolTipPath").style("opacity",.9),this._appends=this._baseGroup.append("g"),y._drawn=!1,y._moveX=void 0,y._moveY=void 0,this.on("remove",function(){y._drawn=!1,t.select("html").node().contains(y._baseGroup.node())&&y._parent.removeChild(y._baseGroup.node())}),this.on("draw",function(t,e){y._parent.appendChild(y._baseGroup.node()),y._container=y.config("container"),y._caretWidth=2*y.config("caretSize"),y._containerBBox=y.config("container").node().getBoundingClientRect(),y._baseGroup.select(".toolTipPath").style("fill",y.config("tooltipBackgroundColor")),y._appends.attr("transform","translate("+y.config("padding")+", "+y.config("padding")+")"),w[y.config("format")](y._appends),u(e,t),d(),b(),y._baseGroup.select(".toolTipPath").attr({transform:y._topPath.translate,d:y._topPath.path}),y._drawn=!0}),this.on("moveTo",function(t,e,o,i){if(l(e),y._drawn){var n=o?o:y._containerBBox.width,a=i?i:y._containerBBox.height,r=y._baseGroup,h=p(n,a,t);e||(e=s(h)),v({left:h.hittingLeft,right:h.hittingRight,top:h.hittingTop,bottom:h.hittingBottom,container:{height:a,width:n},point:t});var g=c(e,h,a,n);r.attr("transform","translate("+g.translateX+","+g.translateY+")"),r.select(".toolTipPath").attr({transform:g.translate,d:g.path})}})}return _inherits(i,e),_createClass(i,[{key:"preDraw",value:function(){this._container=this.config("container")}}]),i}(e.Base),n=i;return n});
//# sourceMappingURL=chart.min.js.map